<html>
  <head>
    <script src="https://www.google.com/recaptcha/api.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css?family=Poppins"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script>
      var postSubmit = false;

      function recaptchaCallback(token) {
        document.getElementById("strike-card-form").submit();
        postSubmit = true;
      }

      const onSubmit = () => {
        postSubmit = true;
      };

      const onPrivacyPolicyClick = () => {
        window.location.hash = "#privacy-policy";
        $("#thank-you").addClass("d-none");
        $("#strike-card").addClass("d-none");
        $("#count").addClass("d-none");
        $("#privacy-policy").removeClass("d-none");
      };

      const onIFrameLoad = () => {
        if (postSubmit) {
          $("#strike-card").addClass("d-none");
          $("#thank-you").removeClass("d-none");

          // update committed and needed counts to reflect user's sign up
          $("#committed").text(
            (
              parseInt($("#committed").text().replaceAll(",", "")) + 1
            ).toLocaleString()
          );
          $("#needed").text(
            (
              parseInt($("#needed").text().replaceAll(",", "")) - 1
            ).toLocaleString()
          );
        }
      };

      const onPageLoad = () => {
        window.addEventListener("popstate", onPageLoad);
        document
          .getElementById("show-privacy-policy")
          .addEventListener("click", onPrivacyPolicyClick);
        document
          .getElementById("strike-card-form")
          .addEventListener("submit", onSubmit);

        setCounts();
        const hash = window.location.hash;
        const search = window.location.search;

        // Use "source" query param if exists, otherwise use referrer as data source
        const source = new URLSearchParams(search).get("source");
        document.forms["strike-card-form"].elements["entry.1105869991"].value =
          source || document.referrer;

        $("#privacy-policy").addClass("d-none");
        $("#thank-you").addClass("d-none");
        $("#strike-card").addClass("d-none");
        $("#count").addClass("d-none");

        if (hash.match(/privacy-policy/i)) {
          $("#privacy-policy").removeClass("d-none");
          return;
        }

        if (search.match(/strikeCardOnly/i)) {
          $("#strike-card").removeClass("d-none");
          return;
        }

        if (search.match(/countOnly/i)) {
          $("#count").removeClass("d-none");
          return;
        }

        // Base case show strike card and counts
        $("#strike-card").removeClass("d-none");
        $("#count").removeClass("d-none");
      };

      const setCounts = () => {
        $.getJSON(
          "https://sheets.googleapis.com/v4/spreadsheets/1mYyT88hdRmohPcTIRyIyBELe1PuAqCiMvpH5I_Hqslk/values/A2?key=AIzaSyBMMBgUg_q89G4VfyUdQ-tVmAQAPpsxTqA",
          function (data) {
            const count = data.values[0][0];

            $("#committed").text((count * 1).toLocaleString());
            $("#needed").text((11000000 - count).toLocaleString());
          }
        );
      };
    </script>
    <style>
      body {
        font-family: Poppins;
        background-color: black;
      }
    </style>
  </head>
  <body onload="onPageLoad()">
    <main>
      <iframe
        name="hidden-iframe"
        style="display: none"
        onload="onIFrameLoad()"
      ></iframe>
      <div class="container text-white px-md-5 mt-5">
        <div id="privacy-policy" class="d-none">
          <h1 class="text-center">General Strike US Privacy Policy</h1>
          <div class="text-center">
            Last Updated: January 5, 2024
            <br />
            This Privacy Policy explains how we collect, use, disclose, and
            protect your personal information as a subscriber to our newsletter
            and recipient of SMS messaging.
          </div>
          <h2>Information We Collect</h2>
          <ol>
            <li>Email Address</li>
            <li>First and Last Name</li>
            <li>Phone Number</li>
            <li>Zip Code</li>
          </ol>

          <h2>How We Use Your Information</h2>
          <ol>
            <li>
              Newsletter Delivery:
              <ul>
                <li>
                  We use your email address to deliver our newsletter to your
                  inbox.
                </li>
              </ul>
            </li>
            <li>
              Personalization:
              <ul>
                <li>
                  We may use your name to personalize our communications with
                  you.
                </li>
              </ul>
            </li>
            <li>
              Analytics:
              <ul>
                <li>
                  We may aggregate zip code data to provide insights about our
                  user base.
                </li>
              </ul>
            </li>
            <li>
              Strike Announcement:
              <ul>
                <li>
                  We may use your email address and phone number to announce
                  when we have reached our strike goal and provide further
                  instructions.
                </li>
              </ul>
            </li>
          </ol>
          <h2>Information Sharing</h2>
          <ol>
            <li>
              Third-Party Service Providers:
              <ul>
                <li>
                  We may use third-party email service providers to deliver our
                  newsletter. These providers are bound by confidentiality
                  agreements and are not allowed to use your information for any
                  purpose other than delivering our newsletter.
                </li>
                <li>
                  We use Peerly, a peer-to-peer texting application, to send you
                  personalized SMS messages to your mobile device.
                </li>
              </ul>
            </li>
          </ol>

          <h2>Your Choices</h2>
          <ol>
            <li>
              Unsubscribe:
              <ul>
                <li>
                  You can unsubscribe from our newsletter at any time by
                  following the unsubscribe link that will be at the bottom of
                  each newsletter. Please allow 7 days for the changes to take
                  effect.
                </li>
                <li>
                  You may unsubscribe from texts by replying STOP to quit.
                </li>
              </ul>
            </li>
            <li>
              Opt-out
              <ul>
                <li>
                  You can fully remove your data from our systems by emailing
                  <a href="mailto:info@generalstrikeus.com"
                    >info@generalstrikeus.com</a
                  >
                  with the subject line "Opt Out". Ensure that the contents of
                  this email contain the email that you signed up with. Please
                  allow 7 days for the changes to take effect. You will receive
                  an email reply to confirm that you have been removed. Once
                  opted out, you may opt back in at any time by re-submitting
                  the strike card
                </li>
              </ul>
            </li>
          </ol>

          <h2>Security</h2>
          <div>
            We take reasonable measures to protect your email address and any
            optional information you provide. However, please be aware that no
            method of transmission over the internet or electronic storage is
            100% secure.
          </div>

          <h2 class="mt-3">Changes to this Privacy Policy</h2>
          <div>
            We may update our Privacy Policy from time to time. Any changes will
            be effective upon posting the updated policy on our website.
          </div>
          <h2 class="mt-3">Contact Us</h2>
          <div>
            If you have any questions about this Privacy Policy or our
            newsletter, please contact us at
            <a href="mailto:info@generalstrikeus.com"
              >info@generalstrikeus.com</a
            >.
          </div>
        </div>
        <div
          id="count"
          class="d-none row text-center mb-5 py-4 border border-white border-3"
        >
          <div class="col">
            <div id="committed" class="fs-2 fw-bold"></div>
            committed
          </div>
          <div class="col">
            <div id="needed" class="fs-2 fw-bold"></div>
            needed
          </div>
        </div>
        <div id="thank-you" class="d-none text-center fs-5">
          You are committed to the General Strike.

          <h1 class="text-center my-4">Welcome!</h1>

          We will Strike when we have 11 million strike commits.
          <br />
          <br />
          How quickly we get there is up to all of usâ€¦
          <br />
          <br />
          <span class="fs-3"
            >What can you do today to get five people to commit to
            striking?</span
          >
          <br />
          1. Talk to people in your life and get them to sign their own Strike
          Cards.
          <br />
          2.
          <a
            class="link-secondary"
            href="https://www.instagram.com/thegeneralstrikeus/"
            target="_blank"
            >Follow & share the Instagram</a
          >
          to spread the work and see updates

          <br />
          <br />
          <span class="fs-1">See you at The Strike!</span>
        </div>
        <div id="strike-card" class="d-none">
          <h1 class="text-center mt-3">Strike Card</h1>
          <p class="text-center fs-5 mt-5">
            Signing a Strike Card is one of most important steps you can take in
            ensuring the success of The General Strike. You will receive
            important email and SMS updates.
            <br />
            Reply STOP to opt out.
            <br />
            <br />
            <span class="fs-6">
              The General Strike is an 100% grassroots organization and your
              data will never be shared or sold.
              <br />
              Check out our
              <button
                id="show-privacy-policy"
                class="link-secondary text-decoration-underline p-0 border-0 bg-transparent"
                href="#privacy-policy"
              >
                privacy policy</button
              >.
            </span>
          </p>
          <form
            id="strike-card-form"
            action="https://us-central1-focal-future-410701.cloudfunctions.net/function-1"
            method="post"
            target="hidden-iframe"
            class="mt-5"
          >
            <div class="form-group mb-3">
              <label for="name">Name</label>
              <input
                class="form-control"
                type="text"
                id="name"
                placeholder="First Last"
                name="entry.862808934"
                required
              />
            </div>
            <div class="form-group mb-3">
              <label for="email">Email</label>
              <input
                class="form-control"
                type="email"
                id="email"
                placeholder="email@domain.com"
                name="entry.592194683"
                required
              />
            </div>
            <div class="row mb-5">
              <div class="form-group col">
                <label for="zip">Zip code</label>
                <input
                  class="form-control"
                  type="text"
                  id="zip"
                  placeholder="#####"
                  pattern="\d{5}"
                  name="entry.28568095"
                  required
                />
              </div>
              <div class="form-group col">
                <label for="phone">Phone number</label>
                <input
                  class="form-control"
                  type="tel"
                  id="phone"
                  placeholder="###-###-####"
                  pattern="[0-9]?-?\(?[0-9]{3}\)?\s?-?[0-9]{3}-?[0-9]{4}"
                  name="entry.389708110"
                  required
                />
              </div>

              <input class="d-none" name="entry.1105869991" />
            </div>

            <div class="d-grid col-4 mx-auto">
              <button
                class="g-recaptcha btn btn-lg btn-outline-light py-4"
                data-sitekey="6LdJnUopAAAAADmyY3TWG2elaTnedjcQ4T6GKp5V"
                data-callback="recaptchaCallback"
                data-action="submit"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>
    </main>
  </body>
</html>
